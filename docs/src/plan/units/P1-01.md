# P1-01: Revise Memory Trait

## Goal

Drop `Clone` bound, change to `&self` for mutations (interior mutability), return
owned data from `entries()`, and add async search methods with default no-ops.

## Depends On

None.

## Design Decisions

- Trait bounds become `Memory: Send + Sync` (no Clone).
- `entries()` returns `Vec<(String, String)>` (owned) for backend flexibility.
- `set()` and `remove()` take `&self`. Implementations use interior mutability.
- `get()` returns `Option<String>` (owned) instead of `Option<&str>`.
- New async methods (`store`, `recall`, `compile_relevant`) use RPITIT — no async-trait crate.
- `store` default delegates to `set`. `recall` default returns empty vec. `compile_relevant` default delegates to `compile()`.
- InMemory wraps its Vec in `std::sync::Mutex` to support `&self` mutation.

## Files

- **MODIFY** `crates/core/src/memory.rs` — revise trait, update InMemory, update tests

## Tests

- All 7 existing tests adapted for owned return types
- NEW: `store_delegates_to_set` — call store, verify get returns the value
- NEW: `compile_relevant_delegates_to_compile` — verify default matches compile()

## Done When

- [ ] `cargo check --workspace` and `cargo test --workspace` pass
- [ ] Memory trait has no Clone bound
- [ ] Async methods compile with RPITIT
