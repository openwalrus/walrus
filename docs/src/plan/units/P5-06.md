# P5-06: Swagger UI and OpenAPI Spec Endpoint

## Goal

Serve the auto-generated OpenAPI specification and Swagger UI from the
Gateway for API discovery and documentation.

## Depends On

P5-05 (REST endpoints with utoipa annotations).

## Design Decisions

- `#[derive(OpenApi)]` struct `ApiDoc` aggregates all annotated paths and
  schemas from the REST module.
- `GET /api-docs/openapi.json` serves the generated OpenAPI 3.0 spec as JSON.
- `GET /swagger-ui/*` serves the Swagger UI frontend via utoipa-swagger-ui.
- Swagger UI always compiled in but gated by `gateway.swagger_ui` config
  flag (defaults to `false`). Runtime toggle, not compile-time — keeps
  the binary identical across environments.
- OpenAPI spec endpoint always available (clients may use it for codegen
  without needing the UI).
- API metadata: title "Walrus Gateway", version from protocol crate's
  `PROTOCOL_VERSION`, description, contact info.

## Files

- **MODIFY** `app/gateway/src/rest.rs` — add ApiDoc struct, openapi.json
  endpoint, merge Swagger UI routes
- **MODIFY** `app/gateway/Cargo.toml` — add utoipa-swagger-ui dep

## Tests

- `openapi_spec_valid_json` — GET /api-docs/openapi.json returns valid JSON
- `openapi_spec_has_paths` — spec contains /v1/send, /v1/stream, /v1/agents
- `swagger_ui_serves` — GET /swagger-ui/ returns 200 HTML

## Done When

- [ ] `cargo check --workspace` and `cargo test --workspace` pass
- [ ] OpenAPI spec served at /api-docs/openapi.json
- [ ] Swagger UI accessible at /swagger-ui/
- [ ] Spec documents all REST endpoints
